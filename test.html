<!DOCTYPE html><html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Advertising Budget Allocator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-gray-100 p-6">
    <div class="max-w-4xl mx-auto bg-white p-6 rounded-xl shadow-md">
      <h1 class="text-2xl font-bold mb-4">Advertising Budget Allocator</h1>
      <form id="budgetForm">
        <div class="grid grid-cols-3 gap-4 mb-4" id="inputContainer">
          <!-- Dynamic Inputs Here -->
        </div>
        <div class="flex items-center gap-4 mb-4">
          <input
            type="number"
            id="totalBudget"
            placeholder="Total Budget"
            class="border p-2 w-48"
            required
          />
          <select
            id="objective"
            class="border p-2 w-48"
            required
          >
            <option value="maximizeGMV">Maximize GMV</option>
            <option value="maximizeROAS">Maximize ROAS</option>
          </select>
          <button
            type="submit"
            class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"
          >
            Allocate Budget
          </button>
        </div>
      </form>
      <div>
        <canvas id="allocationChart"></canvas>
        <div id="allocationDetails" class="mt-4 text-sm"></div>
      </div>
    </div><script>
  const inputContainer = document.getElementById("inputContainer");
  const numChannels = 3;
  for (let i = 0; i < numChannels; i++) {
    const inputGroup = document.createElement("div");
    inputGroup.classList.add("flex", "flex-col", "space-y-1");

    inputGroup.innerHTML = `
      <input type="text" placeholder="Channel ${i + 1}" class="channel border p-2" required />
      <input type="number" placeholder="ROAS" class="roas border p-2" required />
      <input type="number" placeholder="Max Budget" class="maxBudget border p-2" required />
    `;

    inputContainer.appendChild(inputGroup);
  }

  const form = document.getElementById("budgetForm");
  const chartCanvas = document.getElementById("allocationChart");
  let pieChart;

  form.addEventListener("submit", function (e) {
    e.preventDefault();

    const channels = Array.from(document.querySelectorAll(".channel")).map(
      (input) => input.value
    );
    const roas = Array.from(document.querySelectorAll(".roas")).map((input) =>
      parseFloat(input.value)
    );
    const maxBudgets = Array.from(document.querySelectorAll(".maxBudget")).map(
      (input) => parseFloat(input.value)
    );
    const totalBudget = parseFloat(document.getElementById("totalBudget").value);
    const objective = document.getElementById("objective").value;

    const allocations = new Array(channels.length).fill(0);
    let remainingBudget = totalBudget;

    const sortedIndices = [...roas.keys()].sort((a, b) => roas[b] - roas[a]);

    for (const index of sortedIndices) {
      if (remainingBudget <= 0) break;
      const allocate = Math.min(maxBudgets[index], remainingBudget);
      allocations[index] = allocate;
      remainingBudget -= allocate;
    }

    const data = {
      labels: channels,
      datasets: [
        {
          label: "Allocated Budget",
          data: allocations,
          backgroundColor: [
            "#4F46E5",
            "#10B981",
            "#F59E0B",
            "#EF4444",
            "#6366F1",
          ],
        },
      ],
    };

    if (pieChart) pieChart.destroy();
    pieChart = new Chart(chartCanvas, {
      type: "pie",
      data,
    });

    const allocationDetails = document.getElementById("allocationDetails");
    allocationDetails.innerHTML = allocations
      .map(
        (alloc, i) =>
          `<div><strong>${channels[i]}</strong>: RM ${alloc.toFixed(2)} | ROAS: ${roas[i]} | Max: RM ${maxBudgets[i]}</div>`
      )
      .join("");
  });
</script>

  </body>
</html>